# 技術メモ

## Q. Menuの1つ目の項目を自動で選択状態にしたいが、event_generate('<Down>')で動作しない。大幅に遅延時間を増やしても変化がない。原因と修正方法は？

### A. 原因
TkinterのMenuウィジェットは、event_generate('<Down>') をroot（Tkインスタンス）に送っても、現在表示中のポップアップメニュー自体にはイベントが届かないため、自動で1つ目の項目が選択状態になることはありません。

Menuは「キーボードフォーカス」や「イベントの伝播先」が特殊で、rootや親ウィンドウにイベントを送ってもMenu自体がそれを受け取らない仕様です。

### 結論
- Tkinter標準Menuでは「プログラムから特定の項目を選択状態にする」APIはありません。
- event_generateやfocus_set等もMenuには効きません。
- これはTkinterのMenuの設計上の制約です。

### 代替案・現実的な対応
1. 現状維持
　→ ユーザーが最初に上下キーを押すまで、どの項目もハイライトされない（Windows標準の右クリックメニューも同様の挙動）。
2. ListboxやTreeview等、他のウィジェットを使う
　→ これらはプログラムから選択状態を制御できる。
3. Menuの1つ目の項目に「アクセラレータキー」を割り当てる
　→ 1文字キーで即決定できるので、操作性は高い。

---

「どうしても自動選択したい」場合は、ListboxやTreeviewベースのUIに戻すことをおすすめします。 